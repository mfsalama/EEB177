# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.125926114577, 0.125926114577,0.122921102116,0.122997642246,0.118977052459,0.0818366417802,0.0537662355375,0.0587444291173,0.059275597789,0.0596782346003,0.0601438506951,0.0585905538439,0.058931054042,0.0590013142575,0.059275597789,0.0599510041025,0.0599510041025,0.0599510041025,0.0609712440354,0.0599510041025,0.0632540081144,0.0694754953331,0.0810114266466,0.112184000714,0.11420432137,0.115125721087,0.115125721087,0.116682001646,0.122471137324,0.122538046093,0.121529322893,0.121312599583,0.128881134895,0.132153063739,0.133759215724,0.131324805929,0.132153063739,0.129451280161,0.134910111048,0.126148526345,0.121123372246,0.11608930342,0.102947925913,0.0891486781277,0.0814057599116,0.0771907602801,0.0771216385963,0.075062580418,0.075062580418,0.075062580418,0.075062580418,0.0557083832081,0.0557083832081,0.0532046511672)
L_hpd_M95=c(0.318619856905, 0.318619856905,0.315824095689,0.315824095689,0.320064519873,0.311031983427,0.251029368261,0.161928968829,0.158532464669,0.158532464669,0.158532464669,0.156715649387,0.156715649387,0.156715649387,0.156715649387,0.157357460506,0.15903452011,0.161363176094,0.165475866413,0.169775860876,0.19981612138,0.226284596657,0.24634010401,0.259472126573,0.257978272536,0.258234537962,0.257978272536,0.259472126573,0.265749340813,0.270135747726,0.277720930431,0.318928830177,0.344405508351,0.359108786937,0.366989509091,0.366989509091,0.371512264062,0.376086161613,0.388375658043,0.388599909523,0.394930163462,0.421590929823,0.424232118643,0.422116298904,0.422116298904,0.424232118643,0.429010422271,0.429010422271,0.429010422271,0.429010422271,0.429010422271,0.409784874877,0.410291043442,0.409784874877)
M_hpd_m95=c(0.782434072007, 0.782434072007,0.0860298561116,0.0860298561116,0.0864441797856,0.0864441797856,0.0851833226158,0.0838066051587,0.0832687436292,0.0844020133474,0.0851833226158,0.0870474598474,0.0878267133793,0.0874391891259,0.0878267133793,0.0878267133793,0.0855601989147,0.085104033612,0.0878514840538,0.085104033612,0.0850185604712,0.0850185604712,0.0837460932578,0.0829506153933,0.0819949550467,0.0804208546192,0.0801163405945,0.0798856233781,0.0793695344163,0.0780726291837,0.0778978669615,0.0777453181231,0.0741775525306,0.0715195302209,0.0609579616323,0.0437754770693,0.0375706004004,0.0334359019156,0.0306684211917,0.0292277800306,0.0242874755385,0.0238473151952,0.0222501345438,0.0222501345438,0.0222501345438,0.0222501345438,0.0222501345438,0.0222501345438,0.0222501345438,0.0222501345438,0.0222501345438,0.0222501345438,0.0222501345438,0.0222501345438)
M_hpd_M95=c(1.44302842731, 1.44302842731,0.197873121039,0.197873121039,0.197873121039,0.197873121039,0.178771220767,0.145271637178,0.136606652912,0.135336185552,0.134618672025,0.133663258563,0.13324702094,0.132242799329,0.132834433352,0.132864841123,0.130521438038,0.129996477856,0.132708775902,0.130075879021,0.130075879021,0.130075879021,0.129871428221,0.130838163805,0.13063436485,0.129871428221,0.129996477856,0.129996477856,0.130444245964,0.132963111535,0.133663258563,0.133663258563,0.132668132326,0.13324702094,0.134618672025,0.135196782408,0.133663258563,0.13324702094,0.133663258563,0.134618672025,0.135025980468,0.140621029074,0.140621029074,0.140621029074,0.140621029074,0.140621029074,0.140621029074,0.140621029074,0.140621029074,0.140621029074,0.140621029074,0.140621029074,0.140621029074,0.140621029074)
R_hpd_m95=c(-1.25093685299, -1.25093685299,-0.00528197579425,-0.00528197579425,-0.0152875104046,-0.0384153568229,-0.0951140862577,-0.0733585821649,-0.0647802622978,-0.0647802622978,-0.0639203989807,-0.0607861082289,-0.0605561597261,-0.0602834056782,-0.0601763080411,-0.0602834056782,-0.0557913404928,-0.0558086070172,-0.0558086070172,-0.0558086070172,-0.0558086070172,-0.0466199278624,-0.0322006831861,0.0051446651128,0.00924730274824,0.00924730274824,0.00924730274824,0.00924730274824,0.0147496775996,0.0149089677776,0.0147496775996,0.0147496775996,0.0153076184042,0.0199522842472,0.0260403878507,0.0244236026248,0.0240382675181,0.0235237616608,0.0240382675181,0.0152767156032,0.00317874240696,-0.00411597427085,-0.00481136234196,-0.028120158987,-0.03855073822,-0.0458840394248,-0.0458840394248,-0.0483283837835,-0.0409812236703,-0.0409812236703,-0.0410986435821,-0.0409812236703,-0.0410986435821,-0.0532330635099)
R_hpd_M95=c(-0.557267583795, -0.557267583795,0.206054542412,0.205846035164,0.204430224131,0.204818671613,0.155099766588,0.0571325083375,0.0495345390146,0.047917044659,0.047917044659,0.0491706836376,0.0480186386914,0.0480186386914,0.0476856826204,0.047262186932,0.0563824744232,0.0594258798507,0.0611367080001,0.0653950494408,0.0929221538392,0.120642063042,0.141119173584,0.161983960202,0.162808917102,0.162808917102,0.162808917102,0.162676201012,0.165794459494,0.169296023617,0.183960656602,0.218252083215,0.241836251218,0.260198696989,0.271629854249,0.272195421712,0.276886578414,0.283011332056,0.2946091217,0.295544662959,0.300790322275,0.318986248104,0.334998296513,0.321307981212,0.31994876413,0.320320315363,0.321307981212,0.320320315363,0.328956967247,0.328956967247,0.328135206584,0.328956967247,0.328956967247,0.321307981212)
L_mean=c(0.24008291442, 0.24008291442,0.240163317302,0.239967646135,0.236729172384,0.22240863093,0.118756754118,0.0957472540638,0.0944897375323,0.0943543599145,0.094253566791,0.0942861775167,0.0943541794575,0.0945285092223,0.0947666942824,0.0952209391788,0.0987947257985,0.101440033767,0.102807504245,0.104537814224,0.115718054534,0.136800368419,0.178844271222,0.190313574271,0.191151165162,0.191327652957,0.191855734743,0.192573185455,0.195357940699,0.19839186429,0.203524183299,0.214015698304,0.222392812332,0.226869247389,0.230624140984,0.232081718186,0.232935180539,0.233620747952,0.234341914542,0.234938099754,0.236645059687,0.242020882018,0.243345787374,0.239777582958,0.236503221757,0.235140825888,0.234276064434,0.234049009394,0.233870233506,0.233693170116,0.233629807355,0.233506503518,0.233721902256,0.23426572555)
M_mean=c(1.13009273085, 1.13009273085,0.123379049564,0.12337780205,0.123181186486,0.122963743559,0.11663617347,0.111529714384,0.11010121986,0.109695334124,0.109505493798,0.109962450042,0.110056076418,0.109842053481,0.109682988922,0.109564138919,0.109397568005,0.10938118525,0.109419508018,0.109315149047,0.109258851163,0.109099478135,0.108292211063,0.107407843016,0.107136850415,0.106820874555,0.106737450379,0.106660066035,0.106452932625,0.105815099731,0.105633853878,0.105589782008,0.105497248034,0.105495830215,0.104041228822,0.101925830757,0.10045350265,0.0998587284854,0.0996651385655,0.0996304712139,0.100326774613,0.10097102364,0.101287601112,0.101196340216,0.101141274451,0.101141274451,0.101141274451,0.101141274451,0.101141274451,0.101141274451,0.101141274451,0.101141274451,0.101141274451,0.101141274451)
R_mean=c(-0.890009816432, -0.890009816432,0.116784267738,0.116589844084,0.113547985898,0.0994448873705,0.00212058064792,-0.0157824603202,-0.0156114823277,-0.015340974209,-0.0152519270073,-0.0156762725253,-0.0157018969608,-0.0153135442591,-0.0149162946396,-0.0143431997405,-0.0106028422062,-0.00794115148252,-0.00661200377298,-0.00477733482285,0.00645920337077,0.0277008902844,0.0705520601583,0.0829057312555,0.0840143147471,0.0845067784022,0.0851182843633,0.08591311942,0.0889050080742,0.0925767645593,0.0978903294208,0.108425916296,0.116895564298,0.121373417174,0.126582912162,0.13015588743,0.132481677888,0.133762019467,0.134676775976,0.13530762854,0.136318285074,0.141049858377,0.142058186262,0.138581242741,0.135361947306,0.133999551437,0.133134789983,0.132907734943,0.132728959055,0.132551895665,0.132488532904,0.132365229067,0.132580627805,0.133124451099)
trans=0.5
age=(0:(54-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.471911464498), xlim = c(-56.7,2.7), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.58733127004), xlim = c(-56.7,2.7), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.37603053828, 0.368498126164), xlim = c(-56.7,2.7), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-56.7,2.7), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()