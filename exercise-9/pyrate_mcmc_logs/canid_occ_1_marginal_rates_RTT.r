# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.123065888821, 0.123065888821,0.123065888821,0.123065888821,0.118571899354,0.0579555327354,0.0541374556818,0.0532533284115,0.0532533284115,0.0532533284115,0.0532533284115,0.0532533284115,0.053408861496,0.0549239580259,0.0549239580259,0.0549239580259,0.0549239580259,0.0549239580259,0.0549239580259,0.057038653898,0.06535358624,0.117352626449,0.110926532074,0.110926532074,0.116320475441,0.116320475441,0.116320475441,0.116320475441,0.116320475441,0.110926532074,0.140208472939,0.121177342266,0.158964454389,0.161880179392,0.161880179392,0.159226163908,0.159226163908,0.143935646875,0.142368172883,0.132608974729,0.116792358403,0.11505704193,0.113324708039,0.0981576768039,0.103206716862,0.113324708039,0.113324708039,0.0996831489674,0.0926996670707,0.0926996670707,0.0926996670707,0.0926996670707)
L_hpd_M95=c(0.32781463736, 0.32781463736,0.32781463736,0.32781463736,0.32781463736,0.311107927578,0.226801466927,0.167993596697,0.14390823353,0.141541504615,0.139881895912,0.139881895912,0.139881895912,0.138143747343,0.138143747343,0.139881895912,0.147309185945,0.147398439675,0.163556705417,0.197816138948,0.227164746707,0.253390699585,0.23734422837,0.23734422837,0.23734422837,0.23734422837,0.23734422837,0.23734422837,0.244428022123,0.268094628206,0.314560989424,0.333463337752,0.398105951516,0.398605040743,0.398605040743,0.398605040743,0.398605040743,0.398605040743,0.410130157866,0.415083982531,0.415303697372,0.415303697372,0.415303697372,0.415303697372,0.415303697372,0.433873680721,0.433873680721,0.433873680721,0.433873680721,0.433873680721,0.433873680721,0.433873680721)
M_hpd_m95=c(0.939527950007, 0.939527950007,0.0952195407428,0.0952195407428,0.0952195407428,0.0952195407428,0.0952195407428,0.0952195407428,0.0952195407428,0.0952195407428,0.0952195407428,0.0952195407428,0.0952195407428,0.0962196937166,0.092727152436,0.0822112719686,0.0726123485392,0.0726123485392,0.0762954605965,0.0772964455568,0.0762954605965,0.0754005448403,0.069289102606,0.0723939185789,0.069238201977,0.0629101984507,0.0613428991952,0.046065494525,0.046065494525,0.0422034114636,0.0475413513128,0.0475413513128,0.0475413513128,0.0475413513128,0.0475413513128,0.0475413513128,0.0475413513128,0.0475413513128,0.0475413513128,0.0475413513128,0.0475413513128,0.0475413513128,0.0475413513128,0.0475413513128,0.0475413513128,0.0475413513128,0.0475413513128,0.0475413513128,0.0475413513128,0.0475413513128,0.0475413513128,0.0475413513128)
M_hpd_M95=c(1.58098135737, 1.58098135737,0.157674911829,0.157674911829,0.157674911829,0.157674911829,0.157674911829,0.157674911829,0.157674911829,0.157674911829,0.157674911829,0.157674911829,0.157674911829,0.159651267086,0.161793135851,0.155043058003,0.141485955817,0.141040013709,0.144442662878,0.141040013709,0.141040013709,0.141040013709,0.141040013709,0.141040013709,0.138451100199,0.136970091299,0.136970091299,0.131700535681,0.125116148013,0.116503833686,0.125116148013,0.125116148013,0.125116148013,0.125116148013,0.125116148013,0.125116148013,0.125116148013,0.125116148013,0.125116148013,0.125116148013,0.125116148013,0.125116148013,0.125116148013,0.125116148013,0.125116148013,0.125116148013,0.125116148013,0.125116148013,0.125116148013,0.125116148013,0.125116148013,0.125116148013)
R_hpd_m95=c(-1.3054263032, -1.3054263032,0.0155844638377,0.00831502892943,0.00515155776335,-0.081577360971,-0.0933958008028,-0.0893715446671,-0.0893715446671,-0.0933958008028,-0.0933958008028,-0.0933958008028,-0.0933958008028,-0.0933958008028,-0.0877985429543,-0.0794334946596,-0.0777106192362,-0.0835234559983,-0.0677565380616,-0.0666121098808,-0.0514478417127,-0.0144839499056,-0.00531217046521,-0.00911579865083,-0.00531217046521,-0.00360967726514,-0.00313846640791,0.00785902043879,0.0196398463661,0.00851956694204,0.0196398463661,0.0158920406881,0.0465667969221,0.0441774057172,0.0441774057172,0.0441774057172,0.0441774057172,0.0465667969221,0.0417189455199,0.00806702451561,0.0240616353727,0.0240616353727,0.0240616353727,0.00806702451561,0.0209590167683,0.00946137845359,0.00946137845359,0.00851956694204,-0.011929238164,-0.011929238164,-0.011929238164,-0.011929238164)
R_hpd_M95=c(-0.638156391348, -0.638156391348,0.230931611779,0.225057689254,0.228717811923,0.199097531499,0.100026227182,0.0371414327347,0.0286086466584,0.0196398463661,0.0196398463661,0.0196398463661,0.0196398463661,0.0196398463661,0.0196398463661,0.0302979779114,0.0436458143402,0.0474408110925,0.0648068590608,0.0917098562897,0.125693778174,0.135907327644,0.156754255084,0.148575925994,0.144382500154,0.148575925994,0.148575925994,0.159047598584,0.173177458373,0.177860435577,0.219237151867,0.254183252762,0.316194105232,0.316194105232,0.316194105232,0.323459162641,0.323459162641,0.332817555032,0.332817555032,0.313896661666,0.347848203825,0.347848203825,0.347848203825,0.346183805472,0.347848203825,0.347848203825,0.347848203825,0.359224596394,0.347848203825,0.347848203825,0.347848203825,0.347848203825)
L_mean=c(0.258055041272, 0.258055041272,0.257606566274,0.258250188664,0.255123903195,0.188958024353,0.100968249373,0.0923661309505,0.0885019054475,0.0880257986445,0.0882977877046,0.0884575187949,0.0885940736907,0.0889759438247,0.0889759438247,0.0892867442468,0.0909587699024,0.0914625149785,0.0946426524256,0.11110634535,0.153035954834,0.181238962518,0.183552548111,0.183758542383,0.183233224837,0.182030839609,0.182041726038,0.182156109864,0.184981647287,0.191688295773,0.206171374003,0.221960553589,0.240533235317,0.246266283566,0.249235009089,0.251736798803,0.253181265756,0.25615733107,0.253425520337,0.253693721843,0.256695109144,0.257840197918,0.257265798292,0.259211196038,0.260973933007,0.264383950392,0.263865932937,0.26482804415,0.266071289529,0.266071289529,0.266071289529,0.266071289529)
M_mean=c(1.21488167462, 1.21488167462,0.124952613535,0.124952613535,0.124952613535,0.124952613535,0.125001185147,0.125001185147,0.125001185147,0.125001185147,0.125001185147,0.125001185147,0.125001185147,0.124764544206,0.120626387027,0.115826570709,0.111198899334,0.109817806311,0.109562320523,0.110978547439,0.110286900666,0.109552949058,0.107465213343,0.105305610826,0.103040010815,0.101748393092,0.0993812255381,0.0941147154479,0.0907311765615,0.086793319639,0.0860558253387,0.0860558253387,0.0860558253387,0.0860558253387,0.0860558253387,0.0860558253387,0.0860558253387,0.0860558253387,0.0860558253387,0.0860558253387,0.0860558253387,0.0860558253387,0.0860558253387,0.0860558253387,0.0860558253387,0.0860558253387,0.0860558253387,0.0860558253387,0.0860558253387,0.0860558253387,0.0860558253387,0.0860558253387)
R_mean=c(-0.956826633351, -0.956826633351,0.132653952739,0.133297575128,0.13017128966,0.0640054108173,-0.0240329357748,-0.0326350541968,-0.0364992796999,-0.0369753865029,-0.0367033974427,-0.0365436663525,-0.0364071114566,-0.0357886003815,-0.0316504432019,-0.0265398264623,-0.0202401294313,-0.0183552913324,-0.0149196680972,0.000127797911277,0.0427490541685,0.0716860134606,0.0760873347675,0.0784529315566,0.0801932140226,0.0802824465164,0.0826605005001,0.0880413944157,0.0942504707259,0.104894976134,0.120115548664,0.13590472825,0.154477409978,0.160210458227,0.16317918375,0.165680973464,0.167125440418,0.170101505731,0.167369694999,0.167637896504,0.170639283805,0.171784372579,0.171209972953,0.1731553707,0.174918107668,0.178328125054,0.177810107598,0.178772218811,0.18001546419,0.18001546419,0.18001546419,0.18001546419)
trans=0.5
age=(0:(52-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.477261048793), xlim = c(-54.6,2.6), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.73907949311), xlim = c(-54.6,2.6), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.43596893352, 0.395147056033), xlim = c(-54.6,2.6), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-54.6,2.6), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()